<div style="width:100%;max-width:800px;margin:2rem auto 1rem auto;">
  <canvas id="basketChart" style="width:100%;height:320px;"></canvas>
</div>

<p style="text-align:center;max-width:800px;margin:0 auto 2rem auto;color:#666;">
  This chart above tracks the total cost of a basket of goods based on the available prices of goods collected.
</p>

<table>
  <thead>
    <tr>
      <th (click)="setSort('Product')" style="cursor:pointer">
        Product
        <span *ngIf="sortColumn === 'Product'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
      </th>
      <th class="prices-collected-header" (click)="setSort('pricesCollected')" style="cursor:pointer">
        <span class="prices-collected-full">Prices Collected</span>
        <span class="prices-collected-short">#</span>
        <span *ngIf="sortColumn === 'pricesCollected'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
      </th>
      <th (click)="setSort('averagePrice')" style="cursor:pointer">
        Average Price
        <span *ngIf="sortColumn === 'averagePrice'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
      </th>
      <th (click)="setSort('latestDate')" style="cursor:pointer">
        Latest Date
        <span *ngIf="sortColumn === 'latestDate'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
      </th>
      <th (click)="setSort('latestPrice')" style="cursor:pointer">
        Latest Price
        <span *ngIf="sortColumn === 'latestPrice'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
      </th>
      <th class="annual-increase-header" (click)="setSort('annualizedIncrease')" style="cursor:pointer">
        <span class="annual-increase-full">Annualized Increase %</span>
        <span class="annual-increase-short">Annual Incrse %</span>
        <span *ngIf="sortColumn === 'annualizedIncrease'">{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
      </th>
    </tr>
  </thead>
  <tbody>
    @for (stat of filteredStats; track stat) {
      <tr>
        <td>
          <a [routerLink]="['/products', productToSlug(stat.Product)]">
            {{ stat.Product }}
          </a>
        </td>
        <td>{{ stat.pricesCollected }}</td>
        <td>$ {{ stat.averagePrice }}</td>
        <td>{{ stat.latestDate }}</td>
        <td>$ {{ stat.latestPrice }}</td>
        <td>{{ stat.annualizedIncrease }}</td>
      </tr>
    }
  </tbody>
</table>

<div class="toggle-single-price-link">
  <a href="#" (click)="$event.preventDefault(); showAllProducts = !showAllProducts">
    {{ showAllProducts ? 'Show only basket of goods' : 'Show all products' }}
  </a>
</div>
